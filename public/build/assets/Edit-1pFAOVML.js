import{l as M,T as O,m as k,o as r,f as i,b as e,d as u,u as a,e as w,F as U,q as V,t as $,g as x,s as E,v as B,x as R,a as p,w as f,y as v,z as b,A as I,c as q,n as F,O as K}from"./app-CIjyXSyY.js";import{_ as z}from"./AuthenticatedLayout-CitQqfJF.js";import{_ as g}from"./InputLabel-JaxsSoJq.js";import{P as H}from"./PrimaryButton-CjeNhu_i.js";import{_ as G}from"./SecondaryButton-C0ofrMNW.js";import"./ApplicationLogo-KohUWa3L.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W=e("div",{class:"top"},[e("p",null,"Drag & drop images")],-1),Z={key:0},J={key:1,class:"select"},Q={class:"container"},X=["onClick"],Y=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1),ee=[Y],te=["src","alt"],ae={class:"badge-info"},se={class:"my-2"},oe=["value"],le={__name:"UploadImage",props:{id:{type:Number,required:!0}},emits:["uploaded"],setup(S,{emit:d}){M();const o=S,A=d,_=O({id:o.id,images:null}),C=async()=>{_.post(B("camo_activities.add_images"),{onSuccess:()=>{A("uploaded",!0),_.reset()}})},D=k(!1),j=k(null),m=k([]),s=k([]),L=()=>{j.value.click()},t=c=>{const l=c.target.files;if(l.length!==0){for(let n=0;n<l.length;n++)l[n].type.split("/")[0]==="image"&&(m.value.some(h=>h.name===l[n].name)||(m.value.push({name:l[n].name,file:l[n]}),s.value.push({name:l[n].name,url:URL.createObjectURL(l[n])})));_.images=c.target.files}},y=c=>{s.value.splice(c,1),m.value.splice(c,1)},T=c=>{c.preventDefault(),D.value=!0,c.dataTransfer.dropEffect="copy"},N=c=>{c.preventDefault(),D.value=!1},P=c=>{c.preventDefault(),D.value=!1;const l=c.dataTransfer.files;_.images=l;for(let n=0;n<l.length;n++)l[n].type.split("/")[0]==="image"&&(m.value.some(h=>h.name===l[n].name)||(m.value.push({name:l[n].name,file:l[n]}),s.value.push({name:l[n].name,url:URL.createObjectURL(l[n])})))};return(c,l)=>(r(),i("form",{onSubmit:w(C,["prevent"]),onKeydown:l[1]||(l[1]=E(w(()=>{},["prevent"]),["enter"])),class:"card"},[W,e("div",{class:"drag-area",onDragover:w(T,["prevent"]),onDragleave:w(N,["prevent"]),onDrop:w(P,["prevent"])},[D.value?(r(),i("div",J,"Drop images here")):(r(),i("span",Z,[u(" Drag & drop image here or "),e("span",{class:"select",role:"button",onClick:L}," choose ")])),e("input",{type:"file",name:"file",id:"file",ref_key:"fileInput",ref:j,multiple:"",onInput:l[0]||(l[0]=n=>a(_).images=n.target.files),onChange:t},null,544)],32),e("div",Q,[(r(!0),i(U,null,V(m.value,(n,h)=>(r(),i("div",{class:"image",key:h},[e("span",{class:"bg-white inline-flex items-center justify-center w-6 h-6 rounded-full cursor-pointer",onClick:Ve=>y(h)},ee,8,X),e("img",{src:s.value[h].url,alt:s.value.name},null,8,te)]))),128))]),e("div",null,[e("div",null,[u("Added files "),e("span",ae,$(m.value.length),1)])]),a(_).isDirty?(r(),i("button",{key:0,onClick:C,type:"submit"}," Upload ")):x("",!0),e("div",se,[a(_).progress?(r(),i("progress",{key:0,value:a(_).progress.percentage,max:"100"},$(a(_).progress.percentage)+"% ",9,oe)):x("",!0)])],32))}},re={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6 mt-6"},ne={class:"grid grid-cols-2 gap-4"},ie={class:"flex flex-row space-x-3"},de={key:0},ue={class:"flex flex-row justify-around space-x-3"},me={class:"w-1/2"},ce={class:"flex flex-row justify-items-center space-x-3"},pe={class:"my-1"},fe={class:"my-1"},_e=["disabled"],ve=["value"],ge={key:0,class:"my-2"},ye=["value"],be={class:"flex justify-end space-x-4"},he={key:1,class:"border rounded-md px-7 py-2 my-2"},we={class:"list-decimal"},xe={class:"text-sm text-red-500"},ke={key:0},De=e("h2",null,"Activity Images",-1),Ue={class:"container grid grid-cols-2 gap-4 p-4 mx-auto md:grid-cols-4"},$e=["src"],Me={__name:"Edit",props:{resource:{type:Object,default:()=>({})}},setup(S){M();const d=S,o=O({_method:"patch",camo_id:d.resource.data.camo_id,name:d.resource.data.name,date:d.resource.data.date,description:d.resource.data.description,comments:d.resource.data.comments,awr:d.resource.data.awr,labor_mount:d.resource.data.labor_mount,material_mount:d.resource.data.material_mount,material_information:d.resource.data.material_information,status:d.resource.data.status,add_images:null});k(!1);const A=k([{value:"pending",label:"Pending"},{value:"in_progress",label:"in Progress"},{value:"completed",label:"Completed"}]),_=k([{value:"pending",label:"Pending"},{value:"approved",label:"Approved"}]),C=()=>{o.patch(B("camo_activities.update",d.resource.data.id))},D=()=>{const m=d.resource.data.camo_id;K.get(B("camos.show",m),{},{replace:!1})},j=m=>{console.log("Evento uploaded capturado:",m)};return(m,s)=>{const L=R("Head");return r(),i(U,null,[p(L,{title:"Edit Activity"}),p(z,null,{header:f(()=>[e("h2",null,[u("Edit Activity "),e("small",null,$(d.resource.data.id),1)])]),default:f(()=>[e("div",re,[e("form",{onSubmit:w(C,["prevent"]),onKeydown:s[10]||(s[10]=E(w(()=>{},["prevent"]),["enter"]))},[e("div",ne,[e("div",null,[e("div",ie,[e("div",null,[p(g,{for:"name"},{default:f(()=>[u("Activity")]),_:1}),v(e("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=t=>a(o).name=t),class:"rounded-md border-gray-100 bg-gray-200",disabled:"",name:"name",readonly:"",type:"text"},null,512),[[b,a(o).name]])]),a(o).date?(r(),i("div",de,[p(g,{for:"date"},{default:f(()=>[u("Date")]),_:1}),v(e("input",{id:"date","onUpdate:modelValue":s[1]||(s[1]=t=>a(o).date=t),class:"rounded-md border-gray-100 bg-gray-200",disabled:"",name:"date",readonly:"",type:"text"},null,512),[[b,a(o).date]])])):x("",!0)]),e("div",ue,[e("div",null,[p(g,{for:"description"},{default:f(()=>[u("Description")]),_:1}),v(e("textarea",{id:"description","onUpdate:modelValue":s[2]||(s[2]=t=>a(o).description=t),class:"rounded-md border-gray-300 w-full",cols:"30",name:"description",rows:"5"},null,512),[[b,a(o).description]])]),e("div",null,[p(g,{for:"comments"},{default:f(()=>[u("Comments")]),_:1}),e("div",null,[v(e("textarea",{id:"comments","onUpdate:modelValue":s[3]||(s[3]=t=>a(o).comments=t),class:"rounded-md border-gray-300 w-full",cols:"30",name:"comments",rows:"5"},null,512),[[b,a(o).comments]])])])]),e("div",me,[p(g,{for:"material_mount"},{default:f(()=>[u("AWR")]),_:1}),v(e("input",{id:"awr","onUpdate:modelValue":s[4]||(s[4]=t=>a(o).awr=t),class:"rounded-md border-gray-300 w-full",name:"awr",type:"text"},null,512),[[b,a(o).awr]])]),e("div",ce,[e("div",pe,[p(g,{for:"labor_mount"},{default:f(()=>[u("Labor Mount")]),_:1}),v(e("input",{id:"labor_mount","onUpdate:modelValue":s[5]||(s[5]=t=>a(o).labor_mount=t),class:"text-right rounded-md border-gray-300",name:"labor_mount",step:"0.01",type:"number"},null,512),[[b,a(o).labor_mount]])]),e("div",fe,[p(g,{for:"material_mount"},{default:f(()=>[u("Material Mount")]),_:1}),v(e("input",{id:"labor_mount","onUpdate:modelValue":s[6]||(s[6]=t=>a(o).material_mount=t),class:"text-right rounded-md border-gray-300",name:"labor_mount",step:"0.01",type:"number"},null,512),[[b,a(o).material_mount]])])]),e("div",null,[p(g,null,{default:f(()=>[u("Material Information")]),_:1}),v(e("textarea",{id:"description","onUpdate:modelValue":s[7]||(s[7]=t=>a(o).material_information=t),class:"rounded-md border-gray-300 w-full",cols:"30",name:"description",rows:"2"},null,512),[[b,a(o).material_information]])]),e("div",null,[p(g,{for:"status"},{default:f(()=>[u("Status")]),_:1}),v(e("select",{id:"status","onUpdate:modelValue":s[8]||(s[8]=t=>a(o).status=t),disabled:!m.$page.props.auth.user.is_cam,class:"rounded-md border-gray-300",name:"status"},[(r(!0),i(U,null,V(A.value,(t,y)=>(r(),i("option",{key:y,value:t.value},$(t.label),9,ve))),128))],8,_e),[[I,a(o).status]])]),m.$page.props.auth.user.is_owner?(r(),i("div",ge,[p(g,{for:"approval_status"},{default:f(()=>[u("Approval Status")]),_:1}),v(e("select",{id:"status","onUpdate:modelValue":s[9]||(s[9]=t=>a(o).status=t),class:"rounded-md border-gray-300",name:"status"},[(r(!0),i(U,null,V(_.value,(t,y)=>(r(),i("option",{key:y,value:t.value},$(t.label),9,ye))),128))],512),[[I,a(o).status]])])):x("",!0),e("div",be,[a(o).isDirty?(r(),q(H,{key:0,type:"submit"},{default:f(()=>[u("Save")]),_:1})):x("",!0),p(G,{onClick:D},{default:f(()=>[u("Go Back")]),_:1})]),Object.keys(a(o).errors).length>0?(r(),i("div",he,[e("ul",we,[(r(!0),i(U,null,V(a(o).errors,(t,y)=>(r(),i("li",xe,$(t),1))),256))])])):x("",!0)]),e("div",null,[p(le,{id:d.resource.data.id,onUploaded:j},null,8,["id"])])]),d.resource.data.images.length>0?(r(),i("div",ke,[De,e("div",Ue,[(r(!0),i(U,null,V(d.resource.data.images,(t,y)=>(r(),i("div",{key:y,class:F(["w-full h-full rounded shadow-sm min-h-48 aspect-square",{"w-full h-full col-span-2 row-span-2 rounded shadow-sm min-h-96 md:col-start-3 md:row-start-1 bg-gray-500 aspect-square":y===0}])},[e("img",{src:t.original_url,class:"object-contain rounded-md",alt:"..."},null,8,$e)],2))),128))])])):x("",!0)],32)])]),_:1})],64)}}};export{Me as default};
