import{l as T,T as E,m as D,o as r,f as n,b as e,d as u,u as a,e as x,F as U,q as j,t as V,g as k,v as N,s as M,x as R,y as F,a as c,w as p,z as v,A as h,B as O,c as K,O as q}from"./app-askt8K5R.js";import{_ as H}from"./AuthenticatedLayout-C8YoEsIG.js";import{_ as g}from"./InputLabel-CMp-l0Db.js";import{P as z}from"./PrimaryButton-BXnti5dc.js";import{_ as G}from"./SecondaryButton-BhzfGBlS.js";import"./ApplicationLogo-B40Cx27m.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W=e("div",{class:"top"},[e("p",null,"Drag & drop images")],-1),Z={key:0},J={key:1,class:"select"},Q={class:"container"},X=["onClick"],Y=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1),ee=[Y],te=["src","alt"],ae={class:"badge-info"},se={class:"my-2"},oe=["value"],le={__name:"UploadImage",props:{id:{type:Number,required:!0}},emits:["uploaded"],setup(A,{emit:B}){T();const d=A,s=B,f=E({id:d.id,images:null}),S=async()=>{f.post(M("camo_activities.add_images"),{onSuccess:()=>{s("uploaded",!0),f.reset()}})},$=D(!1),C=D(null),y=D([]),_=D([]),o=()=>{C.value.click()},L=m=>{const l=m.target.files;if(l.length!==0){for(let i=0;i<l.length;i++)l[i].type.split("/")[0]==="image"&&(y.value.some(w=>w.name===l[i].name)||(y.value.push({name:l[i].name,file:l[i]}),_.value.push({name:l[i].name,url:URL.createObjectURL(l[i])})));f.images=m.target.files}},I=m=>{_.value.splice(m,1),y.value.splice(m,1)},t=m=>{m.preventDefault(),$.value=!0,m.dataTransfer.dropEffect="copy"},b=m=>{m.preventDefault(),$.value=!1},P=m=>{m.preventDefault(),$.value=!1;const l=m.dataTransfer.files;f.images=l;for(let i=0;i<l.length;i++)l[i].type.split("/")[0]==="image"&&(y.value.some(w=>w.name===l[i].name)||(y.value.push({name:l[i].name,file:l[i]}),_.value.push({name:l[i].name,url:URL.createObjectURL(l[i])})))};return(m,l)=>(r(),n("form",{onSubmit:x(S,["prevent"]),onKeydown:l[1]||(l[1]=N(x(()=>{},["prevent"]),["enter"])),class:"card"},[W,e("div",{class:"drag-area",onDragover:x(t,["prevent"]),onDragleave:x(b,["prevent"]),onDrop:x(P,["prevent"])},[$.value?(r(),n("div",J,"Drop images here")):(r(),n("span",Z,[u(" Drag & drop image here or "),e("span",{class:"select",role:"button",onClick:o}," choose ")])),e("input",{type:"file",name:"file",id:"file",ref_key:"fileInput",ref:C,multiple:"",onInput:l[0]||(l[0]=i=>a(f).images=i.target.files),onChange:L},null,544)],32),e("div",Q,[(r(!0),n(U,null,j(y.value,(i,w)=>(r(),n("div",{class:"image",key:w},[e("span",{class:"bg-white inline-flex items-center justify-center w-6 h-6 rounded-full cursor-pointer",onClick:Ce=>I(w)},ee,8,X),e("img",{src:_.value[w].url,alt:_.value.name},null,8,te)]))),128))]),e("div",null,[e("div",null,[u("Added files "),e("span",ae,V(y.value.length),1)])]),a(f).isDirty?(r(),n("button",{key:0,onClick:S,type:"submit"}," Upload ")):k("",!0),e("div",se,[a(f).progress?(r(),n("progress",{key:0,value:a(f).progress.percentage,max:"100"},V(a(f).progress.percentage)+"% ",9,oe)):k("",!0)])],32))}},re={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6 mt-6"},ne={class:"grid grid-cols-2 gap-4"},ie={class:"flex flex-row space-x-3"},de={key:0},ue={class:"flex flex-row justify-around space-x-3"},me={class:"w-1/2"},ce={class:"flex flex-row justify-items-center space-x-3"},pe={class:"my-1"},_e={class:"my-1"},fe=["disabled"],ve=["value"],ge={key:0,class:"my-2"},ye=["value"],be={class:"flex justify-end space-x-4"},he={key:1,class:"border rounded-md px-7 py-2 my-2"},we={class:"list-decimal"},xe={class:"text-sm text-red-500"},ke={key:0},De=e("h2",null,"Activity Images",-1),$e={class:"flex flex-wrap justify-items-center items-center"},Ue=["href"],Ve=["src","alt"],Oe={__name:"Edit",props:{resource:{type:Object,default:()=>({})}},setup(A){const B=T(),d=A,s=E({_method:"patch",camo_id:d.resource.data.camo_id,name:d.resource.data.name,date:d.resource.data.date,description:d.resource.data.description,comments:d.resource.data.comments,awr:d.resource.data.awr,labor_mount:d.resource.data.labor_mount,material_mount:d.resource.data.material_mount,material_information:d.resource.data.material_information,status:d.resource.data.status,add_images:null});D(!1);const f=D([{value:"pending",label:"Pending"},{value:"in_progress",label:"in Progress"},{value:"completed",label:"Completed"}]),S=D([{value:"pending",label:"Pending"},{value:"approved",label:"Approved"}]),$=()=>{s.patch(M("camo_activities.update",d.resource.data.id))},C=()=>{const _=d.resource.data.camo_id;q.get(M("camos.show",_),{},{replace:!1})},y=_=>{if(_){const o={timeout:2e3,onClose:()=>{d.resource.data.camo_id,C()}};B.success("The images have been uploaded successfully.",o)}};return(_,o)=>{const L=R("Head"),I=F("tooltip");return r(),n(U,null,[c(L,{title:"Edit Activity"}),c(H,null,{header:p(()=>[e("h2",null,[u("Edit Activity "),e("small",null,V(d.resource.data.id),1)])]),default:p(()=>[e("div",re,[e("form",{onSubmit:x($,["prevent"]),onKeydown:o[10]||(o[10]=N(x(()=>{},["prevent"]),["enter"]))},[e("div",ne,[e("div",null,[e("div",ie,[e("div",null,[c(g,{for:"name"},{default:p(()=>[u("Activity")]),_:1}),v(e("input",{id:"name","onUpdate:modelValue":o[0]||(o[0]=t=>a(s).name=t),class:"rounded-md border-gray-100 bg-gray-200",disabled:"",name:"name",readonly:"",type:"text"},null,512),[[h,a(s).name]])]),a(s).date?(r(),n("div",de,[c(g,{for:"date"},{default:p(()=>[u("Date")]),_:1}),v(e("input",{id:"date","onUpdate:modelValue":o[1]||(o[1]=t=>a(s).date=t),class:"rounded-md border-gray-100 bg-gray-200",disabled:"",name:"date",readonly:"",type:"text"},null,512),[[h,a(s).date]])])):k("",!0)]),e("div",ue,[e("div",null,[c(g,{for:"description"},{default:p(()=>[u("Description")]),_:1}),v(e("textarea",{id:"description","onUpdate:modelValue":o[2]||(o[2]=t=>a(s).description=t),class:"rounded-md border-gray-300 w-full",cols:"30",name:"description",rows:"5"},null,512),[[h,a(s).description]])]),e("div",null,[c(g,{for:"comments"},{default:p(()=>[u("Comments")]),_:1}),e("div",null,[v(e("textarea",{id:"comments","onUpdate:modelValue":o[3]||(o[3]=t=>a(s).comments=t),class:"rounded-md border-gray-300 w-full",cols:"30",name:"comments",rows:"5"},null,512),[[h,a(s).comments]])])])]),e("div",me,[c(g,{for:"material_mount"},{default:p(()=>[u("AWR")]),_:1}),v(e("input",{id:"awr","onUpdate:modelValue":o[4]||(o[4]=t=>a(s).awr=t),class:"rounded-md border-gray-300 w-full",name:"awr",type:"text"},null,512),[[h,a(s).awr]])]),e("div",ce,[e("div",pe,[c(g,{for:"labor_mount"},{default:p(()=>[u("Labor Mount")]),_:1}),v(e("input",{id:"labor_mount","onUpdate:modelValue":o[5]||(o[5]=t=>a(s).labor_mount=t),class:"text-right rounded-md border-gray-300",name:"labor_mount",step:"0.01",type:"number"},null,512),[[h,a(s).labor_mount]])]),e("div",_e,[c(g,{for:"material_mount"},{default:p(()=>[u("Material Mount")]),_:1}),v(e("input",{id:"labor_mount","onUpdate:modelValue":o[6]||(o[6]=t=>a(s).material_mount=t),class:"text-right rounded-md border-gray-300",name:"labor_mount",step:"0.01",type:"number"},null,512),[[h,a(s).material_mount]])])]),e("div",null,[c(g,null,{default:p(()=>[u("Material Information")]),_:1}),v(e("textarea",{id:"description","onUpdate:modelValue":o[7]||(o[7]=t=>a(s).material_information=t),class:"rounded-md border-gray-300 w-full",cols:"30",name:"description",rows:"2"},null,512),[[h,a(s).material_information]])]),e("div",null,[c(g,{for:"status"},{default:p(()=>[u("Status")]),_:1}),v(e("select",{id:"status","onUpdate:modelValue":o[8]||(o[8]=t=>a(s).status=t),disabled:!_.$page.props.auth.user.is_cam,class:"rounded-md border-gray-300",name:"status"},[(r(!0),n(U,null,j(f.value,(t,b)=>(r(),n("option",{key:b,value:t.value},V(t.label),9,ve))),128))],8,fe),[[O,a(s).status]])]),_.$page.props.auth.user.is_owner?(r(),n("div",ge,[c(g,{for:"approval_status"},{default:p(()=>[u("Approval Status")]),_:1}),v(e("select",{id:"status","onUpdate:modelValue":o[9]||(o[9]=t=>a(s).status=t),class:"rounded-md border-gray-300",name:"status"},[(r(!0),n(U,null,j(S.value,(t,b)=>(r(),n("option",{key:b,value:t.value},V(t.label),9,ye))),128))],512),[[O,a(s).status]])])):k("",!0),e("div",be,[a(s).isDirty?(r(),K(z,{key:0,type:"submit"},{default:p(()=>[u("Save")]),_:1})):k("",!0),c(G,{onClick:C},{default:p(()=>[u("Go Back")]),_:1})]),Object.keys(a(s).errors).length>0?(r(),n("div",he,[e("ul",we,[(r(!0),n(U,null,j(a(s).errors,(t,b)=>(r(),n("li",xe,V(t),1))),256))])])):k("",!0)]),e("div",null,[d.resource.data.images.length>0?(r(),n("div",ke,[De,e("div",$e,[(r(!0),n(U,null,j(d.resource.data.images,(t,b)=>(r(),n("div",{key:b,class:"p-0.5"},[v((r(),n("a",{href:t.original_url,target:"_blank"},[e("img",{src:t.preview_url,class:"object-contain rounded-md",alt:t.file_name},null,8,Ve)],8,Ue)),[[I,`${t.name}`]])]))),128))])])):k("",!0),c(le,{id:d.resource.data.id,onUploaded:y},null,8,["id"])])])],32)])]),_:1})],64)}}};export{Oe as default};
